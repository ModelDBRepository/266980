This is the readme for the models associated with the paper:


Ricci G, Magosso E, Ursino M *(2021)
The relationship between oscillations in brain regions and functional connectivity: a critical analysis with the aid of neural mass models
Brain sciences

This archive was contributed by G Ricci.

The repository contains two main programs:

1) Simulate_NMM_variousTrials.m: allows the simulation of the Neural Mass Model of four interconnected regions of interest (ROI) and the memorization 
of results in a file ‘simulation.mat’. Each ROI reproduces a neural activity in a different frequency band (ROI 1: beta band, ROI 2: gamma band, ROI 3: 
theta band, ROI 4: alpha band) and its internal parameters are kept constant for the whole study. The network configuration refers to the diagram shown 
in Figure 2.A. However, most of the data analysed in the manuscript can be easily generated by changing the following parameters:
* Wp: 4x4 matrix containing the excitatory synapses where the rows represent the target ROI and the columns the source ROI (for Fig.6)
* Wf: 4x4 matrix containing the inhibitory synapses where the rows represent the target ROI and the columns the source ROI (for Fig.6)

* m(1): mean value of the input to ROI beta (for Fig.7-10, Fig.12)
* m(2): mean value of the input to ROI gamma (for Fig.7-10)
* m(3): mean value of the input to ROI theta (for Fig.7-10)
* m(4): mean value of the input to ROI alpha (for Fig.3, Fig.7-10, Fig.13)

The program performs 10 simulations, using a different noise seed for each trial. Then, it saves the EEG data, the synaptic matrices (Wp, Wf), the input 
mean values (m) and the time vector (tt) in a ‘simulation.mat’ file. It is worth noting that the 10 trials are saved in two different variables, as 
different connectivity estimators require different data organization (Data is used for Granger Causality methods, while Matrix_eeg_C for the other methods).
Finally, in the last section, three Figures are plotted. Figure (1) and Figure (2) show a window of 1 second of respectively spike densities and mean field 
potentials of the pyramidal neurons of the four ROIs; Figure (3) shows the Power Spectral Density computed on the mean field potential of the pyramidal 
neurons in the four ROIs.

2) Connectivity_estimation.m: the program reads the ‘simulation.mat’ file and computes the connectivity estimation with eight different methods: 
Correlation, Delayed Correlation, Coherence, Lagged Coherence, Temporal Granger Causality, Spectral Granger Causality, Phase Synchronization and Transfer 
Entropy. Please note that for Transfer Entropy computation (last section of the program) the user must install the Trentool software package (see 
http://www.trentool.de/ for more details).
Each sections of this program implements a different estimation method which generates at least one Connectivity Matrix (4x4), defined as 'Connectivity_' 
and followed by the estimation method utilized. 
Each Connectivity Matrix is organized as follows: the target ROIs are arranged in rows, while the source ROIs in column, so that the element C_M(i,j) of the 
matrix denotes the connectivity from signal C_M (:,j) to signal C_M(i,:). A further distinction between connectivity estimation methods concerns the 
directionality of the measure. In the case of non-directed measures (Correlation, Coherence, Lagged Coherence and Phase Synchronization) C_M(i,j) = C_M(j,i),
while in the case of directed measures (Delayed Correlation, Temporal Granger Causality, Spectral Granger Causality and Transfer Entropy) C_M(i,j)~=C_M(j,i). 
This means that only in the cases of directional connectivity estimators the source ROI can be distinguished from the target ROI.
Moreover, according to the domain in which the estimator operates (time or frequency), the output matrices can be one or more than one. Specifically, the 
connectivity estimators that work in the time domain (Correlation, Delayed Correlation, Temporal Granger Causality, Phase Synchronization and Transfer 
Entropy) generate a single Connectivity Matrix; while those which operate in the frequency domain (such as Coherence, Lagged Coherence and Spectral Granger
Causality) generate five different Connectivity Matrices. Indeed, in this latter case, one matrix for each of five different frequency bands is produced 
(tot: 2-50 Hz, theta:4-8 Hz, alpha: 8-14 Hz, beta:14-25 Hz, gamma:30-40 Hz).
